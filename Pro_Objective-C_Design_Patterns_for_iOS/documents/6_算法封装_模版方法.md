## 何为模版方法模式

> 定义一个操作中算法的骨架，而将一些步骤延迟到子类中。模版方法使子类可以重定义算法的某些特定步骤而不改变该算法的结构。
>
> ——《设计模式》（Addison-Wesley，1994）

模版方法模式是面向对象软件设计中一种非常简单的设计模式。其基本思想是：在抽象类的方法中定义“标准”算法。在这个方法中调用的基本操作应该由子类重载并予以实现。这个方法被称为“模版”，因为方法定义的算法缺少一些特有的操作。

下图显示了抽象类与具体子类之间的关系——抽象类定义模版，子类重载基本操作以提供独特操作供模版方法调用。

![模版方法模式](https://blog-andy0570-1256077835.cos.ap-shanghai.myqcloud.com/site_Images/173538.png)

`AbstractClass` 不完整地定义了一些方法与算法，留出一些操作未作定义。`AbstractClass` 调用 `templateMethod` 方法时，方法中未定义的空白部分，由它的具体子类  `ConcreteClass` 重载 `primitiveOperation1`（或2）来填补。



## 何时使用模版方法模式

在以下情形，应该考虑使用模板方法。

* 需要一次性实现算法的不变部分，并将可变的行为留给子类来实现。
* 子类的共同行为应该被提取出来放到公共类中，以避免代码重复。现有代码的差别应该被分离为新的操作。然后用一个调用这些新操作的模板方法来替换这些不同的代码。
* 需要控制子类的扩展。可以定义一个在特定点调用“钩子”（hook）操作的模板方法。子类可以通过对钩子操作的实现在这些点扩展功能。

钩子操作给出了默认行为，子类可对其扩展。默认行为通常什么都不做。子类可以重载这个方法，为模板算法提供附加的操作。

模板方法模式中的控制结构流程是倒转的，因为父类的模板方法调用其子类的操作，而不是子类调用父类的操作。这与“好莱坞原则”类似：别给我们打电话，我们会打给你。

模板方法会调用5种类型的操作:

* 对具体类或客户端类的具体操作；
* 对抽象类的具体操作；
* 抽象操作；
* 工厂方法；
* 钩子操作（可选的抽象操作）。